# RedPulse - Security & API Configuration Summary

## ‚úÖ Google Maps API Key Security Implementation

Your Google Maps API key has been configured securely and will NOT be committed to GitHub.

### üîí Protected Files (NOT committed to GitHub):

1. **`.env`** - Environment variables with actual API key
2. **`SECURITY_SETUP.md`** - This file (contains actual key for your reference)
3. **`android/local.properties`** - Android local configuration with API key
4. **`android/key.properties`** - Android signing keys (if created)
5. **`ios/Runner/GoogleService-Info.plist`** - Firebase iOS configuration
6. **`.env.local`** and **`.env.*.local`** - Any local environment overrides

### ‚úÖ Configuration Files Updated:

#### 1. Environment Configuration
- **`.env`** - Contains your actual API key (protected)
- **`.env.example`** - Template for other developers (safe to commit)
- **`lib/core/config/app_config.dart`** - Central configuration class

#### 2. Android Configuration
- **`android/local.properties`** - API key added
- **`android/app/build.gradle.kts`** - Reads API key from local.properties and injects into manifest
- **`android/app/src/main/AndroidManifest.xml`** - Added Google Maps meta-data and all required permissions

#### 3. iOS Configuration
- **`ios/Runner/AppDelegate.swift`** - Google Maps initialized with API key
- **`ios/Runner/Info.plist`** - All permission descriptions added

#### 4. Version Control
- **`.gitignore`** - Updated to exclude all sensitive files including SECURITY_SETUP.md

---

## üì± Permissions Added

### Android Permissions:
```xml
‚úÖ INTERNET - Network access for Firebase and Maps
‚úÖ ACCESS_FINE_LOCATION - Precise location for donor matching
‚úÖ ACCESS_COARSE_LOCATION - Approximate location
‚úÖ ACCESS_BACKGROUND_LOCATION - Background location updates
‚úÖ CAMERA - Profile picture updates
‚úÖ READ_EXTERNAL_STORAGE - Access photos
‚úÖ WRITE_EXTERNAL_STORAGE - Save photos
```

### iOS Permissions:
```plist
‚úÖ NSLocationWhenInUseUsageDescription - "RedPulse needs your location to find nearby blood donors"
‚úÖ NSLocationAlwaysUsageDescription - "RedPulse needs background location for emergency alerts"
‚úÖ NSLocationAlwaysAndWhenInUseUsageDescription - Combined location permission
‚úÖ NSCameraUsageDescription - "Camera access for profile pictures"
‚úÖ NSPhotoLibraryUsageDescription - "Photo library access for profile pictures"
```

---

## üöÄ Features Configured

### ‚úÖ Google Maps Integration
- **Android**: API key injected via build.gradle from local.properties
- **iOS**: API key initialized in AppDelegate.swift
- **Flutter**: Available via `AppConfig.googleMapsApiKey`

### ‚úÖ Firebase Services
- **Authentication**: Email/password login system
- **Cloud Firestore**: Real-time database for users, requests, chats
- **Cloud Storage**: Profile image uploads
- **Cloud Messaging (FCM)**: Push notifications for requests and messages

### ‚úÖ Location Services
- **Geolocator**: Real-time location tracking
- **Geocoding**: Address to coordinates conversion
- **Permission Handler**: Runtime permission requests

### ‚úÖ Chat & Messaging
- Real-time chat between donors and recipients
- Message read receipts
- Unread message counts
- Chat history

### ‚úÖ Profile Management
- User profile with blood group, phone, location
- Profile image upload
- Donation count tracking
- Availability toggle

### ‚úÖ Blood Request System
- Create emergency requests
- SOS mode for instant alerts
- Nearby donor matching by proximity
- Request status tracking (pending/accepted/completed/cancelled)

---

## üõ†Ô∏è How to Build & Run

### First Time Setup:
```bash
# Clean previous builds
flutter clean

# Get dependencies
flutter pub get

# Run on connected device
flutter run
```

### For New Team Members:
```bash
# 1. Clone the repository
git clone https://github.com/samikhan-1800/redpulse.git
cd redpulse

# 2. Copy environment template
cp .env.example .env

# 3. Ask the project admin for the actual Google Maps API key
# Then add it to .env file:
# GOOGLE_MAPS_API_KEY=your_key_here

# 4. Update android/local.properties (auto-generated by Flutter)
# Add line: GOOGLE_MAPS_API_KEY=your_key_here

# 5. Add Firebase config files (get from project admin)
# - Place google-services.json in android/app/
# - Place GoogleService-Info.plist in ios/Runner/

# 6. Run
flutter pub get
flutter run
```

---

## üîê Security Best Practices Implemented

1. ‚úÖ **API keys NOT in source code** - Loaded from environment/build files
2. ‚úÖ **Sensitive files in .gitignore** - Won't be committed to GitHub
3. ‚úÖ **Template files provided** - `.env.example` for team collaboration
4. ‚úÖ **Build-time injection** - Android injects key during gradle build
5. ‚úÖ **Separate config class** - Centralized configuration management
6. ‚úÖ **Documentation excluded** - SECURITY_SETUP.md not committed (contains actual key)

---

## ‚ö†Ô∏è Important Security Reminders

### If You Accidentally Commit Your API Key:

1. **Immediately revoke it** in Google Cloud Console
2. **Generate a new key**
3. **Update local files** with the new key
4. **Clean git history**:
   ```bash
   git filter-branch --force --index-filter \
   "git rm --cached --ignore-unmatch android/local.properties .env SECURITY_SETUP.md" \
   --prune-empty --tag-name-filter cat -- --all
   
   git push origin --force --all
   ```

### Regular Security Checks:

- ‚úÖ Never commit `.env`, `android/local.properties`, or `SECURITY_SETUP.md`
- ‚úÖ Rotate API keys periodically
- ‚úÖ Use API key restrictions in Google Cloud Console:
  - Restrict to Android/iOS app package names
  - Restrict to specific APIs (Maps, Geocoding, etc.)
  - Set usage quotas

---

## üìä Google Cloud Console Setup Required

Enable these APIs in Google Cloud Console:
1. ‚úÖ Maps SDK for Android
2. ‚úÖ Maps SDK for iOS  
3. ‚úÖ Geocoding API
4. ‚úÖ Places API
5. ‚úÖ Directions API (optional, for route navigation)

### Recommended API Restrictions:
```
Application restrictions:
  - Android apps: com.example.redpulse
  - iOS apps: com.example.redpulse

API restrictions:
  - Maps SDK for Android
  - Maps SDK for iOS
  - Geocoding API
  - Places API
```

---

## üêõ Troubleshooting

### Maps Not Loading?
1. Check `android/local.properties` has `GOOGLE_MAPS_API_KEY=...`
2. Check `ios/Runner/AppDelegate.swift` has the correct key
3. Verify APIs are enabled in Google Cloud Console
4. Check API key restrictions aren't blocking your app

### Build Errors?
```bash
flutter clean
flutter pub get
flutter run
```

### Location Not Working?
- Check permissions are granted in device settings
- Ensure location services are enabled
- Check permission descriptions are in Info.plist (iOS) and AndroidManifest.xml

### Firebase Errors?
- Ensure `google-services.json` is in `android/app/`
- Ensure `GoogleService-Info.plist` is in `ios/Runner/`
- Check Firebase project configuration in console

---

## üìû Support

For issues or questions:
- Check `GOOGLE_MAPS_SETUP.md` for detailed setup instructions
- Review error logs in terminal
- Verify all configuration files are properly set up

---

**‚ö†Ô∏è IMPORTANT: This file is in .gitignore and should NEVER be committed to GitHub!**

**Last Updated**: December 6, 2025
**Developer**: Sami Khan (COMSATS University Islamabad, Wah Campus)
